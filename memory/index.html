<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>í•˜ë£¨ë§ˆì¸ë“œ - ê°™ì€ ê·¸ë¦¼ ì°¾ê¸°</title>

  <style>
    :root{
      --bg:#0b1020;
      --card:rgba(255,255,255,.05);
      --card2:rgba(255,255,255,.03);
      --line:rgba(255,255,255,.09);
      --text:#e8ecff;
      --muted:#b9c2ff;
      --accent:#6ee7b7;
      --shadow:0 10px 25px rgba(0,0,0,.35);
      --radius:18px;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", sans-serif;
      background: radial-gradient(1200px 800px at 30% 10%, #1b2457 0%, var(--bg) 55%, #050813 100%);
      color:var(--text);
      display:flex;
      justify-content:center;
      padding:18px;
    }
    .wrap{
      width:min(720px,100%);
      display:flex;
      flex-direction:column;
      gap:14px;
    }
    .card{
      background: linear-gradient(180deg, var(--card), var(--card2));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
    }

    /* ===== ìƒë‹¨ íƒ€ì´í‹€ ===== */
    .titleRow{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:12px;
    }
    .title{
      font-size:22px;
      font-weight:900;
      letter-spacing:-.4px;
    }
    .sub{
      margin-top:6px;
      color:var(--muted);
      font-size:14px;
      line-height:1.35;
    }

    /* ===== ì˜¤ëŠ˜ ìš”ì•½(1ì¤„) ===== */
    .summaryBar{
      margin-top:12px;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.04);
      color:rgba(233,238,255,.95);
      font-weight:800;
      font-size:14px;
      display:flex;
      align-items:center;
      gap:10px;
      justify-content:space-between;
    }
    .summaryLeft{
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .tiny{
      font-size:12px;
      color:rgba(185,194,255,.9);
      font-weight:700;
    }

    /* ===== í•µì‹¬ ì¡°ì‘ 3ê°œ ===== */
    .mainControls{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:12px;
    }
    .control{
      width:100%;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.05);
      color:var(--text);
      padding:12px 12px;
      font-weight:900;
      font-size:16px;
      outline:none;
    }
    select.control{
      appearance:auto;
      font-weight:900;
    }
    .btnPrimary{
      border:2px solid rgba(110,231,183,.45);
      background:rgba(110,231,183,.18);
    }
    .btnPrimary.big{
      grid-column: 1 / -1; /* ìƒˆë¡œ ì‹œì‘ì€ í¬ê²Œ(í•œ ì¤„ ì „ì²´) */
      font-size:18px;
      padding:14px 14px;
      border-radius:16px;
    }

    /* ===== ì„¤ì •(ì ‘ê¸°) ===== */
    details.settings{
      margin-top:12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
      overflow:hidden;
    }
    details.settings > summary{
      list-style:none;
      cursor:pointer;
      padding:12px 14px;
      font-weight:900;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    details.settings > summary::-webkit-details-marker{display:none;}
    .settingsBody{
      border-top:1px solid rgba(255,255,255,.08);
      padding:12px 14px 14px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .settingsBody .control{ font-size:15px; padding:11px 12px; }
    .settingsBody .control.full{ grid-column: 1 / -1; }

    /* ===== ë³´ë“œ ì˜ì—­ ===== */
    .boardCard{ padding:14px; }
    .boardTitle{
      font-size:18px;
      font-weight:900;
      letter-spacing:-.3px;
    }
    .boardTip{
      margin-top:6px;
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
    }

    /* ê¸°ì¡´ UIì—ì„œ ë³´ë“œê°€ ë“¤ì–´ê°ˆ ì»¨í…Œì´ë„ˆ(ê¸°ì¡´ ui.jsê°€ ì—¬ê¸° ë„£ëŠ” êµ¬ì¡°ì¼ ê°€ëŠ¥ì„±) */
    #board{
      margin-top:12px;
      display:grid;
      gap:10px;
    }

    /* í•˜ë‹¨ ì•ˆë‚´ */
    .footerNote{
      color:rgba(185,194,255,.92);
      font-size:12px;
      line-height:1.5;
    }

    /* ëª¨ë°”ì¼: ê¸€ì/ê°„ê²© ì¡°ê¸ˆë§Œ ì¤„ì´ê¸° */
    @media (max-width: 420px){
      body{ padding:14px; }
      .card{ padding:14px; }
      .title{ font-size:20px; }
      .mainControls{ grid-template-columns: 1fr 1fr; }
      .btnPrimary.big{ font-size:17px; }
      .settingsBody{ grid-template-columns: 1fr 1fr; }
    }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- ===== ìƒë‹¨ ì¹´ë“œ ===== -->
    <div class="card">
      <div class="titleRow">
        <div>
          <div class="title">ê°™ì€ ê·¸ë¦¼ ì°¾ê¸°</div>
          <div class="sub">ê°™ì€ ê·¸ë¦¼ 2ê°œë¥¼ ì°¾ì•„ë³´ì„¸ìš”. ì²œì²œíˆ í•´ë„ ê´œì°®ì•„ìš”.</div>
        </div>
      </div>

      <!-- âœ… ì˜¤ëŠ˜ ìš”ì•½ 1ì¤„ (ì •ë³´ì„±) -->
      <div class="summaryBar" aria-live="polite">
        <div class="summaryLeft" id="summaryText">ì˜¤ëŠ˜ 0íŒ ì™„ë£Œ Â· ìµœê³  0ì </div>
        <div class="tiny" id="summaryTiny">ë§ì¶¤ 0 Â· ì ìˆ˜ 0</div>
      </div>

      <!-- âœ… í•µì‹¬ ì¡°ì‘ 3ê°œ -->
      <div class="mainControls">
        <!-- ë‚œì´ë„: (2ë‹¨ê³„ ì¶”ì²œ) -->
        <select id="difficulty" class="control" title="ë‚œì´ë„">
          <option value="easy">ë³´í†µ</option>
          <option value="hard">ì–´ë ¤ì›€</option>
        </select>

        <!-- ì ê¹ë³´ê¸°: 2ì´ˆ ê³ ì • -->
        <button id="peekBtn" class="control" type="button">ì ê¹ë³´ê¸°</button>

        <!-- ìƒˆë¡œ ì‹œì‘: í¬ê²Œ -->
        <button id="restartBtn" class="control btnPrimary big" type="button">ìƒˆë¡œ ì‹œì‘</button>
      </div>

      <!-- âœ… ì„¤ì •: ê¸°ë³¸ ì ‘ê¸° -->
      <details class="settings">
        <summary>
          <span>âš™ï¸ ì„¤ì •</span>
          <span class="tiny">íš¨ê³¼ìŒ Â· í° ê¸€ì”¨ Â· ë°©ë²•</span>
        </summary>
        <div class="settingsBody">
          <button id="soundToggle" class="control" type="button">ğŸ”” íš¨ê³¼ìŒ: ì¼œì§</button>
          <button id="bigTextToggle" class="control" type="button">ğŸ” í° ê¸€ì”¨: êº¼ì§</button>
          <button id="helpBtn" class="control full" type="button">ë°©ë²• ë³´ê¸°</button>
        </div>
      </details>
    </div>

    <!-- ===== ê²Œì„(ë³´ë“œ) ì¹´ë“œ ===== -->
    <div class="card boardCard">
      <div class="boardTitle">ê°™ì€ ê·¸ë¦¼ 2ê°œë¥¼ ì°¾ì•„ë³´ì„¸ìš”!</div>
      <div class="boardTip">íŒ: ë„ˆë¬´ ë¹¨ë¦¬ ëˆ„ë¥´ì§€ ì•Šì•„ë„ ë¼ìš”.</div>

      <!-- ê¸°ì¡´ ê²Œì„ UIê°€ ë Œë”ë§ë  ì˜ì—­ -->
      <div id="board"></div>

      <div style="margin-top:12px;" class="footerNote">
        ë³¸ ì„œë¹„ìŠ¤ëŠ” ì˜ë£Œ ëª©ì ì´ ì•„ë‹Œ, ì¼ìƒì ì¸ ì¸ì§€ ìê·¹ì„ ìœ„í•œ ë†€ì´ì…ë‹ˆë‹¤.<br/>
        í•˜ë£¨ë§ˆì¸ë“œ Â· harumind.kr
      </div>
    </div>

  </div>

  <!-- ===== ê¸°ì¡´ ë¶„ë¦¬ íŒŒì¼ ë¡œë“œ(í˜„ì¬ êµ¬ì¡° ìœ ì§€) ===== -->
  <script src="./config.js"></script>
  <script src="./storage.js"></script>
  <script src="./ui.js"></script>
  <script src="./game.js"></script>

  <!-- ===== UI ì—°ê²°(í•µì‹¬: ìš”ì•½ 1ì¤„ + ë²„íŠ¼ ì´ë²¤íŠ¸) ===== -->
  <script>
    // âœ… ê°’ í‘œì‹œìš©(ê¸°ì¡´ ì½”ë“œê°€ ì•„ë˜ idë“¤ì„ ì“°ê³  ìˆì„ ê°€ëŠ¥ì„± ë†’ì•„ì„œ ìˆ¨ì€ ìƒíƒœë¡œ ìœ ì§€)
    // (ê¸°ì¡´ ì½”ë“œê°€ ì§ì ‘ DOMì„ ì°¾ëŠ”ë‹¤ë©´ ë„ì›€ì´ ë¨)
    const hidden = document.createElement('div');
    hidden.style.display = 'none';
    hidden.innerHTML = `
      <span id="todayKey"></span>
      <span id="matched">0</span>
      <span id="score">0</span>
      <span id="todayClear">0</span>
      <span id="todayBest">0</span>
    `;
    document.body.appendChild(hidden);

    // âœ… ìš”ì•½ 1ì¤„ ì—…ë°ì´íŠ¸
    function refreshSummary(){
      const todayClear = document.getElementById('todayClear')?.textContent?.trim() || '0';
      const todayBest  = document.getElementById('todayBest')?.textContent?.trim()  || '0';
      const matched    = document.getElementById('matched')?.textContent?.trim()    || '0';
      const score      = document.getElementById('score')?.textContent?.trim()      || '0';

      document.getElementById('summaryText').textContent = `ì˜¤ëŠ˜ ${todayClear}íŒ ì™„ë£Œ Â· ìµœê³  ${todayBest}ì `;
      document.getElementById('summaryTiny').textContent = `ë§ì¶¤ ${matched} Â· ì ìˆ˜ ${score}`;
    }
    setInterval(refreshSummary, 600);

    // âœ… ì ê¹ë³´ê¸°(2ì´ˆ ê³ ì •) - ê¸°ì¡´ í•¨ìˆ˜ê°€ ìˆìœ¼ë©´ ê·¸ê±¸ í˜¸ì¶œ, ì—†ìœ¼ë©´ ì´ë²¤íŠ¸ë§Œ ë˜ì§
    const peekBtn = document.getElementById('peekBtn');
    peekBtn.addEventListener('click', () => {
      // 1) ê¸°ì¡´ ì „ì—­ í•¨ìˆ˜ê°€ ìˆìœ¼ë©´ ìš°ì„  ì‚¬ìš©
      if (typeof window.peek === 'function') return window.peek(2000);
      if (typeof window.showPeek === 'function') return window.showPeek(2000);

      // 2) ì•„ë‹ˆë©´ ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸(ê¸°ì¡´ game.jsì—ì„œ ë°›ì„ ìˆ˜ë„ ìˆìŒ)
      window.dispatchEvent(new CustomEvent('HARUMIND_PEEK', { detail: { ms: 2000 } }));
    });

    // âœ… ìƒˆë¡œ ì‹œì‘
    const restartBtn = document.getElementById('restartBtn');
    restartBtn.addEventListener('click', () => {
      if (typeof window.newGame === 'function') return window.newGame();
      if (typeof window.restart === 'function') return window.restart();
      window.dispatchEvent(new Event('HARUMIND_RESTART'));
    });

    // âœ… ë‚œì´ë„(2ë‹¨ê³„) - ê¸°ì¡´ ì„¤ì • í•¨ìˆ˜ê°€ ìˆìœ¼ë©´ ì‚¬ìš©
    const difficulty = document.getElementById('difficulty');
    difficulty.addEventListener('change', () => {
      const v = difficulty.value; // easy/hard
      if (typeof window.setDifficulty === 'function') return window.setDifficulty(v);
      window.dispatchEvent(new CustomEvent('HARUMIND_DIFFICULTY', { detail: { level: v } }));
    });

    // âœ… íš¨ê³¼ìŒ/í°ê¸€ì”¨/ë°©ë²•ë³´ê¸°
    const soundToggle = document.getElementById('soundToggle');
    const bigTextToggle = document.getElementById('bigTextToggle');
    const helpBtn = document.getElementById('helpBtn');

    soundToggle.addEventListener('click', () => {
      if (typeof window.toggleSound === 'function') window.toggleSound();
      window.dispatchEvent(new Event('HARUMIND_TOGGLE_SOUND'));
    });

    bigTextToggle.addEventListener('click', () => {
      if (typeof window.toggleBigText === 'function') window.toggleBigText();
      window.dispatchEvent(new Event('HARUMIND_TOGGLE_BIGTEXT'));
    });

    helpBtn.addEventListener('click', () => {
      if (typeof window.openHelp === 'function') return window.openHelp();
      if (typeof window.showHelp === 'function') return window.showHelp();
      window.dispatchEvent(new Event('HARUMIND_HELP'));
    });

    // ìƒíƒœ í…ìŠ¤íŠ¸ëŠ” ê¸°ì¡´ ì½”ë“œê°€ localStorage ê°™ì€ ê³³ì— ì €ì¥í•œë‹¤ë©´ ê±°ê¸°ì— ë§ì¶° ì—…ë°ì´íŠ¸ë˜ê²Œ í™•ì¥ ê°€ëŠ¥
    function syncToggles(){
      // ğŸŒ‘ ì¶”ì¸¡: ê¸°ì¡´ storage.jsê°€ sound/bigText ìƒíƒœë¥¼ ì €ì¥í•  ê°€ëŠ¥ì„±ì´ ë†’ìŒ
      // ì•ˆì „í•˜ê²Œ ê¸°ë³¸ë§Œ ìœ ì§€. (ì›í•˜ë©´ ì‹¤ì œ í‚¤ì— ë§ì¶° ë™ê¸°í™”í•´ì¤„ê²Œìš”.)
    }
    syncToggles();
  </script>
</body>
</html>
