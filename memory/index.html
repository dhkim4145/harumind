<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>í•˜ë£¨ë§ˆìŒ - ê°™ì€ ê·¸ë¦¼ ì°¾ê¸°</title>

<!-- Google Analytics 4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JX8PENN22H"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-JX8PENN22H');
</script>

<style>
:root{
  --bg:#0b1020;
  --text:#e8ecff;
  --muted:#b9c2ff;
  --accent:#6ee7b7;
  --shadow:0 10px 25px rgba(0,0,0,.35);
  --radius:18px;

  /* ê¸°ë³¸ í¬ê¸°(ì¡°ì ˆìš©) */
  --fs-base:16px;
  --fs-title:20px;
  --fs-msg:18px;
  --fs-hint:14px;
  --fs-pill:14px;
  --tile-h:90px;
  --tile-fs:42px;
  --gap:12px;
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family: system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif;
  background: radial-gradient(1200px 800px at 30% 10%, #1b2457 0%, var(--bg) 55%, #050813 100%);
  color:var(--text);
  display:flex;
  justify-content:center;
  padding:18px;
  font-size:var(--fs-base);
}

/* âœ… í° ê¸€ì”¨ ëª¨ë“œ */
body.bigText{
  --fs-base:18px;
  --fs-title:24px;
  --fs-msg:22px;
  --fs-hint:16px;
  --fs-pill:16px;
  --tile-h:104px;
  --tile-fs:52px;
  --gap:14px;
}

.wrap{
  width:min(560px,100%);
  display:flex;
  flex-direction:column;
  gap:14px;
}
.card{
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border:1px solid rgba(255,255,255,.08);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:16px;
}
.titleRow{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
}
.title{font-size:var(--fs-title);font-weight:900;}
.sub{font-size:14px;color:var(--muted);margin-top:6px;}

/* âœ… 1ë‹¨ê³„: ê¸°ë¡(í†µê³„) ì ‘ê¸° UI */
.statsHeader{
  margin-top:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
}
.statsToggle{
  font-size:14px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.06);
  color:var(--text);
  padding:8px 12px;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  gap:8px;
}
.chev{
  display:inline-block;
  transition:transform .18s ease;
  opacity:.9;
}
#statsWrap.isOpen .chev{ transform:rotate(180deg); }

.stats{
  display:flex;gap:10px;flex-wrap:wrap;
  margin-top:10px;
}
.pill{
  background:rgba(255,255,255,.07);
  border:1px solid rgba(255,255,255,.12);
  border-radius:999px;
  padding:6px 12px;
  font-size:var(--fs-pill);
}

/* ì ‘íŒ ìƒíƒœ */
#statsWrap:not(.isOpen) .stats{ display:none; }

.controls{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-top:12px;
}
button,select{
  font-size:16px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(255,255,255,.08);
  color:var(--text);
  padding:10px 14px;
  cursor:pointer;
}
button.primary{
  background:rgba(110,231,183,.18);
  border-color:rgba(110,231,183,.45);
}

/* âœ… ì ê¹ë³´ê¸° ë“œë¡­ë‹¤ìš´ ìˆ¨ê¹€(ê¸°ëŠ¥ìš©ìœ¼ë¡œë§Œ ìœ ì§€) */
#peekSec{
  position:absolute;
  left:-9999px;
  width:1px; height:1px;
  opacity:0;
  pointer-events:none;
}

#msg{font-size:var(--fs-msg);font-weight:900;}
#hint{font-size:var(--fs-hint);color:var(--muted);margin-top:4px;}

.board{display:grid;gap:var(--gap);}
.tile{
  height:var(--tile-h);
  border-radius:18px;
  background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
  border:1px solid rgba(255,255,255,.12);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:var(--tile-fs);
  cursor:pointer;
  user-select:none;
  position:relative;
}
.tile[data-state="down"]::after{content:"?";font-weight:900;}
.tile[data-state="up"]::after{content:attr(data-emoji);}
.tile.matched{
  border-color:var(--accent);
  box-shadow:0 0 0 2px rgba(110,231,183,.35) inset;
}

/* âœ… 2ë‹¨ê³„: ì‹œì‘ ì§í›„ 1~2ì´ˆ â€œ?â€ ê¹œë¹¡ì„ */
@keyframes qBlink{
  0%,100%{opacity:1;transform:scale(1);}
  50%{opacity:.35;transform:scale(.98);}
}
body.hintMode .tile[data-state="down"]::after{
  animation:qBlink .9s ease-in-out infinite;
}
body.hintMode .tile[data-state="down"]{
  box-shadow:0 0 0 2px rgba(255,255,255,.08) inset;
}

/* ë°©ë²• ë³´ê¸° íŒì—… */
.modalBack{
  position:fixed; inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:50;
}
.modal{
  background:#1a2250;
  border-radius:18px;
  padding:20px;
  max-width:520px;
}
.modalTitle{font-size:20px;font-weight:900;}
.modalBody{
  margin-top:12px;
  font-size:18px;
  line-height:1.85;
  color:#eef2ff;
}

/* âœ… ë§ì·„ì„ ë•Œ ë³´ìƒ ì—°ì¶œ */
.reward{
  position:fixed;
  font-size:22px;
  font-weight:900;
  color:var(--accent);
  pointer-events:none;
  animation: rewardPop 0.9s ease-out forwards;
  text-shadow:0 2px 8px rgba(0,0,0,.45);
  z-index:70;
}
@keyframes rewardPop{
  0%{opacity:0;transform:translate(-50%,10px) scale(0.6);}
  30%{opacity:1;transform:translate(-50%,0) scale(1.15);}
  100%{opacity:0;transform:translate(-50%,-18px) scale(1);}
}

/* âœ… ì™„ë£Œ íŒì—… (ìë™ ë‹«í˜ ì—†ìŒ) */
.finishBack{
  position:fixed; inset:0;
  background:rgba(0,0,0,.45);
  z-index:90;
  opacity:0;
  animation: dimIn 0.35s ease-out forwards;
}
.finishCard{
  position:fixed;
  left:50%; top:26%;
  transform:translateX(-50%);
  z-index:100;
  width:min(440px, calc(100% - 36px));
  background:#1a2250;
  border:1px solid rgba(110,231,183,.55);
  border-radius:22px;
  box-shadow:0 18px 48px rgba(0,0,0,.55);
  padding:18px 20px;
  text-align:center;
  opacity:0;
  animation: cardIn 0.38s ease-out forwards;
}
.finishCard .big{font-size:22px;font-weight:900;}
.finishCard .small{
  margin-top:8px;
  font-size:14px;
  color:var(--muted);
  line-height:1.6;
  white-space: pre-line; /* âœ… \n ì¤„ë°”ê¿ˆ ë°˜ì˜ */
}
.finishCard .actions{
  margin-top:14px;
  display:flex;
  justify-content:center;
  gap:10px;
  flex-wrap:wrap;
}
.finishCard .actions button{
  font-size:16px;
  border-radius:999px;
  border:1px solid rgba(110,231,183,.45);
  background:rgba(110,231,183,.18);
  color:var(--text);
  padding:10px 14px;
  cursor:pointer;
}
@keyframes dimIn{from{opacity:0;}to{opacity:1;}}
@keyframes cardIn{
  0%{opacity:0; transform:translateX(-50%) translateY(14px) scale(.96);}
  100%{opacity:1; transform:translateX(-50%) translateY(0) scale(1);}
}
</style>
</head>

<body>
<div class="wrap">

  <div class="card">
    <div class="titleRow">
      <div class="title">ê°™ì€ ê·¸ë¦¼ ì°¾ê¸°</div>
    </div>

    <!-- âœ… 1ë‹¨ê³„: í•œ ì¤„ë¡œ ë” ë‹¨ìˆœí™” -->
    <div class="sub">ê°™ì€ ê·¸ë¦¼ 2ê°œë¥¼ ì²œì²œíˆ ì°¾ì•„ë³´ì„¸ìš” ğŸ™‚</div>

    <!-- âœ… ê¸°ë¡/í†µê³„ëŠ” ê¸°ë³¸ ì ‘ê¸° -->
    <div id="statsWrap">
      <div class="statsHeader">
        <button class="statsToggle" id="statsToggle" type="button" aria-expanded="false">
          ê¸°ë¡ ë³´ê¸° <span class="chev">âˆ¨</span>
        </button>
      </div>

      <div class="stats">
        <div class="pill">ì˜¤ëŠ˜ì˜ ê²Œì„ <b id="todayKey"></b></div>
        <div class="pill">ë§ì¶˜ ê°œìˆ˜ <b id="matched">0</b></div>
        <div class="pill">ì¹­ì°¬ì ìˆ˜ <b id="score">0</b></div>
        <div class="pill">ì˜¤ëŠ˜ ì™„ë£Œ <b id="todayClear">0</b>íšŒ</div>
        <div class="pill">ì˜¤ëŠ˜ ìµœê³  <b id="todayBest">0</b>ì </div>
      </div>
    </div>

    <!-- âœ… ë²„íŠ¼ ìˆœì„œ ì •ë¦¬: í–‰ë™ â†’ ë„ì›€ â†’ ì„¤ëª… â†’ ì„¤ì • -->
    <div class="controls">
      <select id="level" title="ë‚œì´ë„ ì„ íƒ">
        <option value="2x2">ì‰¬ì›€ (2x2)</option>
        <option value="3x2" selected>ë³´í†µ (3x2)</option>
        <option value="4x3">ì–´ë ¤ì›€ (4x3)</option>
      </select>

      <button class="primary" id="newGame">ìƒˆë¡œ ì‹œì‘</button>
      <button id="peekBtn" type="button" title="ì¹´ë“œë¥¼ 2ì´ˆ ë™ì•ˆ ë³´ì—¬ì¤˜ìš”">ğŸ‘€ ì ê¹ë³´ê¸° (2ì´ˆ)</button>
      <button id="howBtn">ë°©ë²• ë³´ê¸°</button>

      <button id="sfxBtn" title="íš¨ê³¼ìŒ ì¼œê¸°/ë„ê¸°">ğŸ”” íš¨ê³¼ìŒ: ì¼œê¸°</button>
      <button id="bigBtn" title="ê¸€ì/ë²„íŠ¼ í¬ê²Œ">ğŸ” í° ê¸€ì”¨: ë„ê¸°</button>
    </div>

    <!-- âœ… ui.jsê°€ ì“°ëŠ” selectëŠ” ìœ ì§€í•˜ë˜, í™”ë©´ì—ì„œëŠ” ìˆ¨ê¹€ -->
    <select id="peekSec" aria-hidden="true" tabindex="-1">
      <option value="" selected>_</option>
      <option value="2">2</option>
    </select>
  </div>

  <div class="card">
    <div id="msg">ì¹´ë“œë¥¼ ëˆŒëŸ¬ì„œ ì‹œì‘í•´ìš” ğŸ™‚</div>
    <div id="hint">íŒ: ë„ˆë¬´ ë¹¨ë¦¬ ëˆ„ë¥´ì§€ ì•Šì•„ë„ ë¼ìš”.</div>
  </div>

  <div class="card">
    <div class="board" id="board"></div>
  </div>

  <div class="card" style="font-size:12px;color:var(--muted); line-height:1.5;">
    ë³¸ ì„œë¹„ìŠ¤ëŠ” ì˜ë£Œ í–‰ìœ„ê°€ ì•„ë‹ˆë©°, ì¸ì§€ ìê·¹ì„ ìœ„í•œ ë†€ì´ì…ë‹ˆë‹¤.<br/>
    ê°œì¸ ê¸°ë¡ì€ ë”°ë¡œ ì €ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br/>
    í•˜ë£¨ë§ˆìŒ Â· harumind.kr
  </div>

</div>

<div class="modalBack" id="modalBack">
  <div class="modal">
    <div class="modalTitle">ê²Œì„ ë°©ë²•</div>
    <div class="modalBody">
      1) ë¬¼ìŒí‘œ(?) ì¹´ë“œë¥¼ ëˆŒëŸ¬ ê·¸ë¦¼ì„ í™•ì¸í•´ìš”.<br/>
      2) ê°™ì€ ê·¸ë¦¼ 2ê°œë¥¼ ì°¾ìœ¼ë©´ ì„±ê³µì´ì—ìš”.<br/>
      3) í‹€ë ¤ë„ ê´œì°®ì•„ìš” ğŸ˜Š ë‹¤ì‹œ í•´ë³´ë©´ ë©ë‹ˆë‹¤.<br/><br/>
      ì²˜ìŒì—” <b>ì‰¬ì›€(2x2)</b>ì´ ì¢‹ì•„ìš”.<br/>
      í•˜ë£¨ì— í•œ ë²ˆë§Œ í•´ë„ ì¶©ë¶„í•´ìš”.
    </div>
    <button style="margin-top:14px;" onclick="HarumindUI.closeModal()">ë‹«ê¸°</button>
  </div>
</div>

<!-- ìˆœì„œ ì¤‘ìš”: config â†’ storage â†’ ui â†’ game -->
<script src="./config.js"></script>
<script src="./storage.js"></script>
<script src="./ui.js"></script>
<script src="./game.js"></script>

<!-- âœ… 1ë‹¨ê³„+2ë‹¨ê³„+ì ê¹ë³´ê¸° ë²„íŠ¼í™”: index.htmlë§Œìœ¼ë¡œ ë™ì‘ -->
<script>
(function(){
  const msgEl = document.getElementById('msg');
  const hintEl = document.getElementById('hint');
  const newGameBtn = document.getElementById('newGame');

  let firstClickDone = false;
  let hintTimer = null;

  function startHint(){
    firstClickDone = false;

    document.body.classList.add('hintMode');
    if (hintTimer) clearTimeout(hintTimer);
    hintTimer = setTimeout(() => {
      document.body.classList.remove('hintMode');
    }, 1600);

    if (msgEl) msgEl.textContent = "ì¹´ë“œë¥¼ ëˆŒëŸ¬ì„œ ì‹œì‘í•´ìš” ğŸ™‚";
    if (hintEl) hintEl.textContent = "ì²˜ìŒì—” ì²œì²œíˆ ëˆŒëŸ¬ë³´ë©´ ë¼ìš”.";
  }

  // âœ… ì²˜ìŒ ë¡œë“œ ì‹œ 1íšŒ
  startHint();

  // âœ… â€œìƒˆë¡œ ì‹œì‘â€ ëˆŒë €ì„ ë•Œë„ ë‹¤ì‹œ 1íšŒ
  if (newGameBtn) {
    newGameBtn.addEventListener('click', () => {
      setTimeout(startHint, 120);
    });
  }

  // âœ… ì¹´ë“œ ì²« í´ë¦­ 1íšŒ ì•ˆë‚´
  document.addEventListener('click', (e) => {
    const tile = e.target.closest && e.target.closest('.tile');
    if (!tile) return;

    document.body.classList.remove('hintMode');

    if (!firstClickDone) {
      firstClickDone = true;
      if (msgEl) msgEl.textContent = "ğŸ‘ ì˜í–ˆì–´ìš”! ê°™ì€ ê·¸ë¦¼ì„ í•œ ë²ˆ ë” ì°¾ì•„ë³´ì„¸ìš”.";
      if (hintEl) hintEl.textContent = "íŒ: ë‘ ì¥ì´ ê°™ìœ¼ë©´ ê³„ì† ë§ì¶°ì§‘ë‹ˆë‹¤.";
      setTimeout(() => {
        if (hintEl) hintEl.textContent = "íŒ: ë„ˆë¬´ ë¹¨ë¦¬ ëˆ„ë¥´ì§€ ì•Šì•„ë„ ë¼ìš”.";
      }, 5000);
    }
  }, { passive:true });

  // âœ… ê¸°ë¡ ì ‘ê¸°/í¼ì¹˜ê¸°
  const wrap = document.getElementById('statsWrap');
  const btn = document.getElementById('statsToggle');
  if (wrap && btn) {
    btn.addEventListener('click', () => {
      const open = wrap.classList.toggle('isOpen');
      btn.setAttribute('aria-expanded', open ? 'true' : 'false');
      btn.firstChild.textContent = open ? 'ê¸°ë¡ ë‹«ê¸° ' : 'ê¸°ë¡ ë³´ê¸° ';
    });
  }

  // âœ… ì ê¹ë³´ê¸° ë²„íŠ¼ â†’ ê¸°ì¡´ select(change)ë¥¼ ê°•ì œë¡œ ì‹¤í–‰
  const peekBtn = document.getElementById('peekBtn');
  const peekSel = document.getElementById('peekSec');

  if (peekBtn && peekSel) {
    peekBtn.addEventListener('click', () => {
      peekBtn.disabled = true;

      peekSel.value = "2";
      peekSel.dispatchEvent(new Event('change', { bubbles: true }));

      setTimeout(() => {
        peekSel.value = "";
        peekBtn.disabled = false;
      }, 2200);
    });
  }
})();
</script>
</body>
</html>
