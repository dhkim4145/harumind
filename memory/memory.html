<!doctype html>
<html lang="ko">
<head>
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
      
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />

<meta name="naver-site-verification" content="9a17421f3eca307a085f00983e810d49b7172fdd" />

<script async src="https://www.googletagmanager.com/gtag/js?id=G-JX8PENN22H"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-JX8PENN22H');
</script>

<title>ê°™ì€ ê·¸ë¦¼ ì°¾ê¸° | í•˜ë£¨ë§ˆìŒ</title>
<meta name="description" content="ê°™ì€ ê·¸ë¦¼ì˜ ì§ì„ ì°¾ìœ¼ë©° ì‹œì„ ì„ ì •ë¦¬í•˜ëŠ” ê¸°ì–µë ¥ ê²Œì„ì…ë‹ˆë‹¤." />
<link rel="canonical" href="https://harumind.kr/memory/" />

<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="manifest" href="/site.webmanifest">

<meta property="og:type" content="website" />
<meta property="og:site_name" content="í•˜ë£¨ë§ˆìŒ" />
<meta property="og:title" content="ê°™ì€ ê·¸ë¦¼ ì°¾ê¸° | í•˜ë£¨ë§ˆìŒ" />
<meta property="og:description" content="ê°™ì€ ê·¸ë¦¼ì˜ ì§ì„ ì°¾ìœ¼ë©° ì‹œì„ ì„ ì •ë¦¬í•˜ëŠ” ê¸°ì–µë ¥ ê²Œì„ì…ë‹ˆë‹¤." />
<meta property="og:url" content="https://harumind.kr/memory/" />
<meta property="og:image" content="https://harumind.kr/og.png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />

<style>
:root {
    --bg: #0b1020;
    --card-bg: rgba(255,255,255,.06);
    --card-border: rgba(255,255,255,.08);
    --text: #e8ecff;
    --muted: #b9c2ff;
    --accent: var(--color-point, #A8E6CF);
    --radius: var(--radius-card, 24px);
    --card-back-icon: none; /* ë™ì ìœ¼ë¡œ ì„¤ì •ë  ë³€ìˆ˜ */
}

html, body {
    scroll-behavior: auto !important;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
    margin: 0;
    font-family: system-ui, -apple-system, "Noto Sans KR", sans-serif;
    background: var(--bg);
    color: var(--text);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    padding: 20px;
    transition: background 1.5s ease;
}

.sub{
  font-size:13px;
  color:var(--muted);
  margin-top:8px;
  opacity:.95;
  line-height:1.35;
}

header { 
    text-align: center; 
    margin-bottom: 10px; 
    width: 100%;
    pointer-events: auto;
}
.brand { 
    font-size: 1.2rem; 
    font-weight: 900; 
    color: var(--text); 
    opacity: 0.95;
    animation: titleFadeIn 0.6s ease-out;
}

@keyframes titleFadeIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.attendance-line {
    font-size: 11px;
    color: var(--accent);
    opacity: 0.9;
    margin-bottom: 4px;
    width: 100%;
    text-align: left;
    padding: 0 2px;
}

/* ===== ìƒë‹¨ ê¸°ì¤€ ì»¨í…Œì´ë„ˆ ===== */
.top-container {
    width: 100%;
    max-width: 560px;
    margin: 0 auto;
    padding: 8px 8px 16px;
    box-sizing: border-box;
}

/* ===== Top Bar (ìµœì‹  ê¸€ë¼ìŠ¤ëª¨í”¼ì¦˜ + ë„¤ì˜¨ ê´‘ì±„) ===== */
.top-bar {
    position: sticky;
    top: 0;
    z-index: 1000;
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    border-radius: 0 0 var(--radius-card, 24px) var(--radius-card, 24px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.12);
    background: rgba(20, 27, 63, 0.4);
    backdrop-filter: blur(var(--blur-modal, 18px)) saturate(180%);
    box-shadow: 
        0 8px 32px 0 rgba(31, 38, 135, 0.37),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    box-sizing: border-box;
}

.top-bar button,
.top-bar select {
    height: 40px;
    width: 40px;
    border-radius: var(--radius-small, 16px);
    flex: 0 0 auto;
    border: 1px solid rgba(255, 255, 255, 0.18);
    background: rgba(255, 255, 255, 0.05);
    color: white;
    padding: 0;
    cursor: pointer;
    backdrop-filter: blur(var(--blur-default, 12px));
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
}

.top-bar button svg,
.top-bar select svg {
    width: 20px;
    height: 20px;
    stroke: white;
    stroke-width: 1.5;
    fill: none;
    stroke-linecap: round;
    stroke-linejoin: round;
    z-index: 2;
    position: relative;
}

.top-bar button:hover {
    background: rgba(255, 255, 255, 0.12);
    border-color: var(--color-point-hover, #B8F6DF);
    box-shadow: 0 0 20px rgba(168, 230, 207, 0.3);
}

.top-bar button:active,
.top-bar select:active {
    transform: scale(0.92);
    box-shadow: 
        0 0 20px rgba(255, 255, 255, 0.6),
        0 0 40px rgba(168, 230, 207, 0.5),
        inset 0 0 20px rgba(168, 230, 207, 0.2);
    background: var(--color-point-active, #98D6BF);
    border-color: var(--color-point, #A8E6CF);
}

.top-bar button.off {
    opacity: 0.4;
}

.top-title{
  flex: 1;
  text-align: center;
  font-size: 0.95rem;
  font-weight: 900;
  color: var(--text);
  letter-spacing: 0.2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

@media (max-width: 520px) {
    .top-bar {
        padding: 10px 12px;
        gap: 8px;
    }
    .top-bar button,
    .top-bar select {
        height: 36px;
        width: 36px;
    }
    .top-bar button svg,
    .top-bar select svg {
        width: 18px;
        height: 18px;
    }
    .top-title {
        font-size: 0.9rem;
    }
}


/* ===== Controls Top (íŒíŠ¸, ë‚œì´ë„) ===== */
.controls-top {
    display: flex;
    gap: 8px;
    margin-top: 8px;
}

.controls-top button,
.controls-top select {
    flex: 1;
    height: 36px;
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.16);
    background: rgba(255,255,255,0.08);
    color: var(--text);
    padding: 0 12px;
    font-size: 12px;
    cursor: pointer;
    backdrop-filter: blur(6px);
    transition: opacity 0.2s ease, transform 0.1s ease;
}

.controls-top button:active,
.controls-top select:active {
    transform: scale(0.97);
}

/* ===== Difficulty Selector Buttons ===== */
.difficulty-selector {
    margin-top: 8px;
}

.difficulty-btn {
    flex: 1;
    height: 44px;
    border-radius: 12px;
    border: 1.5px solid rgba(255,255,255,0.16);
    background: rgba(255,255,255,0.08);
    color: var(--text);
    padding: 0 12px;
    font-size: 13px;
    font-weight: 700;
    cursor: pointer;
    backdrop-filter: blur(6px);
    transition: all 0.2s ease;
}

.difficulty-btn:active {
    transform: scale(0.97);
}

.difficulty-btn.active {
    border-color: rgba(110,231,183,0.6);
    background: rgba(110,231,183,0.18);
    color: var(--accent);
    box-shadow: 0 0 12px rgba(110,231,183,0.2);
}

/* (ê¸°ì¡´ ì„¤ì • ë²„íŠ¼ ìŠ¤íƒ€ì¼ì€ í˜¸í™˜ì„± ìœ ì§€) */


/* ===== ì»¨íŠ¸ë¡¤ - Glassmorphism ===== */
.controls{
  display:flex;
  flex-wrap: nowrap;
  align-items: flex-start;
  gap:12px;
  margin-top:12px;
  position:relative;
  min-width:0;
  width:100%;
  touch-action: pan-y;
  contain: layout style;
}

.controls #level{
  flex: 0 1 auto;
  min-width: 120px;
  width: 130px !important;
}

.controls #peekBtn{
  position: static;
  flex: 0 0 auto;
  white-space: nowrap;
  min-width: 120px;
  width: 130px !important;
  display: flex;
  justify-content: center;
  align-items: center;
}

.controls-hint{
  margin: 0;
  margin-left: auto !important;
  flex: 1;
  font-size: 0.9rem;
  font-weight: 300;
  color: var(--muted);
  line-height: 1.4;
  min-width: 0;
  text-align: left;
}

button, select{
  font-size:16px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.08);
  background:rgba(255,255,255,.04);
  backdrop-filter:blur(8px);
  color:var(--text);
  padding:12px 16px;
  cursor:pointer;
  transition: transform 0.15s cubic-bezier(0.4, 0, 0.2, 1), background 0.2s ease, box-shadow 0.2s ease;
  min-width:0;
  max-width:100%;
  height:44px; /* ê³ ì • ë†’ì´ë¡œ ë³€ê²½í•˜ì—¬ ë‚´ë¶€ í…ìŠ¤íŠ¸ ë³€í™” ì‹œì—ë„ ë†’ì´ ìœ ì§€ */
  box-sizing:border-box;
  box-shadow:0 2px 8px rgba(138, 43, 226, 0.1);
  display:flex;
  align-items:center;
  justify-content:center;
  outline: none; /* ë¸Œë¼ìš°ì € ê¸°ë³¸ ê°•ì¡° íš¨ê³¼ ì œê±° */
  -webkit-tap-highlight-color: transparent; /* í„°ì¹˜ ì‹œ í•˜ì´ë¼ì´íŠ¸ ì œê±° */
  touch-action: none; /* ë”ë¸” íƒ­ í™•ëŒ€ ì™„ì „ ì°¨ë‹¨ */
}

button:active, select:active{
  transform: scale(0.96);
  box-shadow:0 1px 4px rgba(138, 43, 226, 0.15);
}

button:hover, select:hover{
  background:rgba(255,255,255,.06);
  box-shadow:0 3px 10px rgba(138, 43, 226, 0.12);
}

select#level{
  font-weight:600;
  background:rgba(255,255,255,.04);
  backdrop-filter:blur(8px);
  border:1px solid rgba(255,255,255,.08);
  color: var(--text);
  min-height:44px;
  box-shadow:0 2px 8px rgba(138, 43, 226, 0.1);
  text-align: center;
  text-align-last: center;
}

select#level option{
  color:#1f2937;
  background:#ffffff;
}
select#level option:checked{
  background:#e6f4ee;
  color:#0f172a;
  font-weight:700;
}

button.primary{
  background:rgba(110,231,183,.18);
  border-color:rgba(110,231,183,.45);
}

/* âœ… ë©”ì‹œì§€ ì¹´ë“œ ì•„ë˜ì— 'ë§ì¶˜ ê°œìˆ˜ / ì§€ê¸ˆ ì ìˆ˜'ë§Œ */

/* ë©”ì‹œì§€ */
.messageCard{ 
  display:flex;
  flex-direction:column;
  contain: layout style;
}
.messageCard > *:first-child{
  flex-shrink:0;
}
#msg{
  font-size:var(--fs-msg);
  font-weight:900;
  white-space:pre-line;
  line-height:1.5;
  min-height:48px;
  max-height:48px;
  display:flex;
  align-items:center;
  transition:opacity 0.4s ease;
  opacity:1;
  overflow:hidden;
  flex-shrink:0;
}
#msg.fadeOut{
  opacity:0;
}
#hint{
  font-size:var(--fs-hint);
  color:var(--muted);
  margin-top:2px;
  white-space:pre-line;
  line-height:1.5;
  min-height:20px;
  max-height:20px;
  display:flex;
  align-items:center;
  transition:opacity 0.4s ease;
  opacity:1;
  overflow:hidden;
  flex-shrink:0;
}
#hint.fadeOut{
  opacity:0;
}

/* ë³´ë“œ */
.game-board-wrapper{
  width: 100%;
  box-sizing: border-box;
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.08);
  border-radius: var(--radius-card, 24px);
  box-shadow: 0 10px 25px rgba(0,0,0,.35);
  padding: 8px;
  margin-bottom: 10px;
}

.board{ 
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  grid-auto-rows: minmax(80px, 1fr);
  width: 100%;
  box-sizing: border-box;
  gap: 6px;
  justify-items: stretch;
  align-items: stretch;
  height: auto;
  overflow: hidden; 
  touch-action: pan-y;
  padding: 0px;
  background: transparent;
  border-radius: 0px;
  border: none;
  perspective: 1000px;
  contain: layout style;
  will-change: transform;
  pointer-events: auto;
  position: relative;
}

.tile{
  aspect-ratio: 1 / 1;
  width: 100%;
  min-width: 0;
  border-radius:var(--radius-card, 24px);
  background: linear-gradient(135deg, rgba(168, 230, 207, 0.08), rgba(168, 230, 207, 0.02));
  border: 2px solid var(--color-point-hover, #B8F6DF);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:2.2rem;
  font-weight:900;
  cursor:pointer;
  user-select:none;
  position:relative;
  box-sizing:border-box;
  touch-action: none;
  contain: layout style paint;
  will-change: transform, opacity, background, border-color, box-shadow;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  transform: translateZ(0);
  transition: background 0.25s ease-out, border-color 0.25s ease-out, box-shadow 0.25s ease-out;
  backdrop-filter: blur(var(--blur-default, 12px));
  box-shadow: 0 4px 15px rgba(168, 230, 207, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.1);
  overflow: hidden;
}

/* ê°€ìƒ ìš”ì†Œ ê¸°ë³¸ê°’: í•­ìƒ ìƒì„±ë˜ë„ë¡ ë³´ì¥ */
.tile::after{
  content: "";
  display: block;
}

/* ì¹´ë“œ ì—´ë¦° ìƒíƒœ - ê°•ì¡°ëœ ìŠ¤íƒ€ì¼ */
.tile[data-state="up"] {
  background: linear-gradient(135deg, var(--color-point-active, #98D6BF), rgba(168, 230, 207, 0.15));
  border-color: var(--color-point, #A8E6CF);
  box-shadow: 0 6px 20px rgba(168, 230, 207, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

.tile::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.5s;
  pointer-events: none;
}

/* í´ë¦­ ì‹œ ëˆŒë¦¬ëŠ” ëŠë‚Œ */
.tile:active:not(.matched){
  transform: scale(1.05) translateZ(0);
}

/* í˜¸ë²„ íš¨ê³¼ (PCìš©) */
@media (hover: hover){
  .tile:not(.matched):not([data-state="up"]):hover{
    background: linear-gradient(135deg, var(--color-point-hover, #B8F6DF), rgba(168, 230, 207, 0.15));
    border-color: var(--color-point, #A8E6CF);
    box-shadow: 0 6px 20px rgba(168, 230, 207, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.3);
    transform: translateY(-2px) translateZ(0);
  }
  .tile:not(.matched):not([data-state="up"]):hover::before{
    left: 100%;
  }
}

.tile[data-state="down"]::after{
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 60%;
  height: 60%;
  margin: auto;
  background-image: var(--card-back-icon) !important;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  opacity: 0.5;
  transform: scaleX(1);
  z-index: 20;
  pointer-events: none;
  display: block;
  /* ë°±í˜ì´ìŠ¤ëŠ” ë¯¼íŠ¸ ê¸€ë¡œìš° - ë³€ìˆ˜í™”ëœ í„ìŠ¤ ì‚¬ìš© */
  --glow-color: rgba(110, 231, 183, 0.6);
  --inner-glow: 2px;
  --outer-glow: 5px;
  animation: pulseGlow 2.2s ease-in-out infinite;
}

@keyframes pulseGlow {
  0%, 100% {
    filter:
      drop-shadow(0 0 var(--inner-glow, 2px) white)
      drop-shadow(0 0 var(--outer-glow, 5px) var(--glow-color, rgba(110, 231, 183, 0.7)));
  }
  50% {
    filter:
      drop-shadow(0 0 calc(var(--inner-glow, 2px) + 1px) white)
      drop-shadow(0 0 calc(var(--outer-glow, 5px) + 2px) var(--glow-color, rgba(110, 231, 183, 0.8)));
  }
}

.tile[data-state="up"]::after{
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 60%;
  height: 60%;
  margin: auto;
  background-image: var(--front-icon) !important;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  opacity: 1;
  transform: scaleX(1);
  z-index: 20;
  pointer-events: none;
  display: block;
  /* ì•ë©´ì€ ì•„ì´ì½˜ ê³ ìœ  ê¸€ë¡œìš° ì»¬ëŸ¬ë¥¼ ê°•í•˜ê²Œ */
  --glow-color: var(--icon-glow, rgba(110, 231, 183, 0.9));
  --inner-glow: 2px;
  --outer-glow: 7px;
  animation: pulseGlow 2.2s ease-in-out infinite;
}

/* ì¹´ë“œ ì—´ê¸° ì• ë‹ˆë©”ì´ì…˜ - ì¹´ë“œ ì „ì²´ íšŒì „ */
.tile.opening[data-state="up"] {
  animation: cardFlipOpen 0.35s ease-out forwards;
}

/* ì¹´ë“œê°€ ì—´ë¦´ ë•Œ íšŒì „ ì• ë‹ˆë©”ì´ì…˜ */
@keyframes cardFlipOpen{
  0%{ transform: scaleX(1); }
  50%{ transform: scaleX(0); }
  100%{ transform: scaleX(1); }
}

/* ì¹´ë“œ ë‹«í ë•Œ ì• ë‹ˆë©”ì´ì…˜ - ë‹«íˆê¸° ì „ê¹Œì§€ëŠ” up ìƒíƒœ ìœ ì§€ */
.tile.closing {
  animation: cardFlipClose 0.35s ease-out forwards;
}

.tile.closing[data-state="up"] {
  background: linear-gradient(135deg, var(--color-point-active, #98D6BF), rgba(168, 230, 207, 0.15));
  border-color: var(--color-point, #A8E6CF);
  box-shadow: 0 6px 20px rgba(168, 230, 207, 0.4), inset 0 1px 0 rgba(255, 255, 255, 0.3);
}

@keyframes cardFlipClose {
  0%{ transform: scaleX(1); }
  50%{ transform: scaleX(0); }
  100%{ transform: scaleX(1); }
}

.tile.matched{
  background: transparent;
  border-color: transparent;
  box-shadow: none;
  animation: successBounce 0.45s ease-out;
  pointer-events: none;
}

@keyframes successBounce {
  0%{
    transform: translateY(0) scale(1);
    opacity: 1;
  }
  30%{
    transform: translateY(-10px) scale(1.1);
  }
  100%{
    transform: translateY(0) scale(1);
    opacity: 1;
  }
}

/* Leave a tiny star at center on matched */
.tile.matched::after{
  content: "" !important;
  position: absolute;
  top: 50%;
  left: 50%;
  width: 2px;
  height: 2px;
  margin: 0;
  transform: translate(-50%, -50%);
  background: white;
  border-radius: 50%;
  box-shadow: 0 0 4px 1px white;
  z-index: 30;
  pointer-events: none;
  /* override any icon image */
  background-image: none !important;
}

/* Glow burst when matched */
.tile.glow-burst::after{
  animation: glowBurst 0.6s ease-out;
}

@keyframes glowBurst{
  0%{
    filter: drop-shadow(0 0 3px white) drop-shadow(0 0 25px var(--glow-color, rgba(110, 231, 183, 0.9)));
  }
  100%{
    filter: drop-shadow(0 0 2px white) drop-shadow(0 0 var(--outer-glow, 7px) var(--glow-color, rgba(110, 231, 183, 0.7)));
  }
}

/* Rainbow sweep finale */
body.rainbow-sweep::before{
  content: "";
  position: fixed;
  inset: 0;
  left: -100%;
  width: 200%;
  height: 100%;
  pointer-events: none;
  z-index: 1000;
  background: linear-gradient(90deg,
    rgba(255,0,0,0.0) 0%,
    rgba(255,0,120,0.25) 15%,
    rgba(255,150,0,0.25) 30%,
    rgba(255,255,0,0.25) 45%,
    rgba(0,255,150,0.3) 60%,
    rgba(0,150,255,0.3) 75%,
    rgba(180,0,255,0.25) 90%,
    rgba(0,0,0,0.0) 100%);
  mix-blend-mode: screen;
  opacity: 0.35;
  animation: rainbowSweep 1.25s ease-out forwards;
}

@keyframes rainbowSweep{
  0%{ transform: translateX(0); opacity: 0.0; }
  10%{ opacity: 0.25; }
  50%{ opacity: 0.4; }
  100%{ transform: translateX(50%); opacity: 0.0; }
}

/* Twinkle stars brighter during rainbow sweep */
body.rainbow-sweep .tile.matched::after{
  animation: twinkle 1.2s ease-in-out 2;
}

@keyframes twinkle{
  0%{ box-shadow: 0 0 4px 1px white; }
  50%{ box-shadow: 0 0 10px 2px white; }
  100%{ box-shadow: 0 0 4px 1px white; }
}

/* Result modal glass + floating icons */
#resultModalBack.isOpen{ display: flex; }
#resultModalBack{ position: fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:1100; background: rgba(0,0,0,0.3); backdrop-filter: blur(6px); }
#resultModalCard{ position: relative; width: min(420px, 90vw); padding: 20px; border-radius: 18px; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15); box-shadow: 0 10px 40px rgba(110, 231, 183, 0.25); backdrop-filter: blur(14px); color: var(--text); }
.floatingIcons{ position:absolute; inset:-10px; pointer-events:none; }
.floatingIcons .icon{ position:absolute; width:28px; height:28px; background-size:contain; background-repeat:no-repeat; opacity:0.85; animation: drift 6s ease-in-out infinite; }
@keyframes drift{ 0%{ transform: translateY(0)} 50%{ transform: translateY(-6px)} 100%{ transform: translateY(0)} }

@keyframes bounceUp{
  0%{ transform: translateY(0) translateZ(0); }
  50%{ transform: translateY(-12px) translateZ(0); }
  100%{ transform: translateY(0) translateZ(0); }
}

/* ëª¨ë‹¬ */
#modalBack{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  z-index:9000;
  display:none;
  pointer-events:none;   /* âœ… ì¶”ê°€: ì•ˆ ë³´ì¼ ë•Œ í„°ì¹˜ë„ ë§‰ì§€ ì•Šê²Œ */
  align-items:center;
  justify-content:center;
  padding:18px;
}
/* ëª¨ë‹¬ ì—´ë¦¼ ìƒíƒœ */
#modalBack.isOpen{
  display:flex;
  pointer-events:auto;
}
#modalCard{
  width:min(520px, 100%);
  background:rgba(20, 27, 63, 0.85);
  backdrop-filter:blur(var(--blur-modal, 18px));
  border:1px solid rgba(255,255,255,.08);
  border-radius:var(--radius-card, 24px);
  box-shadow:0 18px 48px rgba(0,0,0,.55), 0 4px 16px rgba(138, 43, 226, 0.2);
  padding:20px 20px 18px;
}
.modalTitle{ font-weight:900; font-size:18px; }
.modalBody{
  margin-top:10px;
  line-height:1.8;
  color:var(--muted);
  font-size:14px;
}
.modalStep{ display:flex; gap:10px; margin:10px 0; }
.modalNum{
  width:26px; height:26px;
  border-radius:999px;
  background:var(--color-point-active, #98D6BF);
  border:1px solid var(--color-point, #A8E6CF);
  display:flex; align-items:center; justify-content:center;
  font-weight:800; color:var(--text);
  flex:0 0 auto;
}
.modalActions{
  margin-top:14px;
  display:flex;
  justify-content:flex-end;
  gap:10px;
}
.modalActions button{
  font-size:16px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.08);
  background:rgba(255,255,255,.04);
  backdrop-filter:blur(8px);
  color:var(--text);
  padding:12px 20px;
  cursor:pointer;
  min-height:44px;
  box-shadow:0 2px 8px rgba(138, 43, 226, 0.1);
  transition: transform 0.15s cubic-bezier(0.4, 0, 0.2, 1), background 0.2s ease, box-shadow 0.2s ease;
}
.modalActions button:active{
  transform: scale(0.96);
  box-shadow:0 1px 4px rgba(138, 43, 226, 0.15);
}
.modalActions button:hover{
  background:rgba(255,255,255,.06);
  box-shadow:0 3px 10px rgba(138, 43, 226, 0.12);
}

/* ê²°ê³¼ ëª¨ë‹¬ */
#resultModalBack{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  z-index:9001;
  display:none;
  pointer-events:none;
  align-items:center;
  justify-content:center;
  padding:18px;
}
#resultModalBack.isOpen{
  display:flex;
  pointer-events:auto;
}
#resultModalCard{
  width:min(420px, 100%);
  background:#141b3f;
  border:1px solid rgba(255,255,255,.10);
  border-radius:var(--radius-card, 24px);
  backdrop-filter: blur(var(--blur-modal, 18px));
  box-shadow:0 18px 48px rgba(0,0,0,.45);
  padding:24px 20px;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:12px;
  text-align:center;
}
.resultEmoji{
  font-size:48px;
  margin-bottom:4px;
}
.resultMessage{
  font-size:16px;
  color:var(--muted);
  line-height:1.5;
}
.resultRestartBtn{
  font-size:16px;
  font-weight:800;
  border-radius:var(--radius-small, 16px);
  color:var(--text);
  padding:12px 20px;
  cursor:pointer;
  min-width:180px;
  transition: all 0.15s ease;
  border:1px solid var(--color-point, #A8E6CF);
  background:var(--color-point-active, #98D6BF);
}
.resultRestartBtn:active{
  transform: scale(0.98);
}

/* =========================
   ì„¤ì • ëª¨ë‹¬
   ========================= */
#settingsModalBack{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  z-index:9002;
  display:none;
  pointer-events:none;
  align-items:center;
  justify-content:center;
  padding:18px;
}
#settingsModalBack.isOpen{
  display:flex;
  pointer-events:auto;
}
#settingsModalCard{
  width:min(420px, 100%);
  background: rgba(20, 27, 63, 0.7);
  backdrop-filter: blur(var(--blur-modal, 18px)) saturate(180%);
  border:1px solid rgba(255, 255, 255, 0.15);
  border-radius:var(--radius-card, 24px);
  box-shadow:0 18px 48px rgba(0,0,0,.45), 0 8px 32px 0 rgba(31, 38, 135, 0.37);
  padding:28px 24px;
  display:flex;
  flex-direction:column;
  gap:24px;
  animation: slideUpModal 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

@keyframes slideUpModal {
  from {
    opacity: 0;
    transform: translateY(40px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.settingsModalTitle{
  font-size:20px;
  font-weight:900;
  color:var(--text);
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
}

.settingsModalTitle button {
  background: none;
  border: none;
  font-size: 24px;
  color: var(--text);
  cursor: pointer;
  padding: 0;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  opacity: 0.7;
}

.settingsModalTitle button:hover {
  opacity: 1;
  transform: rotate(90deg);
}

.settingsSection {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.settingLabel {
  font-size: 13px;
  color: var(--text);
  font-weight: 700;
  letter-spacing: 0.3px;
  opacity: 0.95;
}
.top-title{
  flex: 1;
  text-align: center;
  font-size: 0.95rem;
  font-weight: 900;
  color: var(--text);
  letter-spacing: 0.2px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.settingsSection{
  display:flex;
  flex-direction:column;
  gap:8px;
}
.settingLabel{
  font-size:12px;
  color:var(--muted);
  font-weight:700;
  text-transform:uppercase;
  letter-spacing:0.5px;
  opacity:0.85;
}

/* ===== í† ê¸€ ìŠ¤ìœ„ì¹˜ ===== */
.toggle-switch {
  display: flex;
  align-items: center;
  gap: 12px;
}

.toggle-label {
  font-size: 14px;
  color: var(--text);
  flex: 1;
}

.toggle-input {
  position: relative;
  width: 56px;
  height: 32px;
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid var(--color-point-hover, #B8F6DF);
  border-radius: var(--radius-small, 16px);
  cursor: pointer;
  transition: all 0.3s ease;
  flex-shrink: 0;
}

.toggle-input.on {
  background: var(--color-point-active, #98D6BF);
  border-color: var(--color-point, #A8E6CF);
}

.toggle-input::after {
  content: '';
  position: absolute;
  top: 2px;
  left: 2px;
  width: 28px;
  height: 28px;
  background: white;
  border-radius: 14px;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
}

.toggle-input.on::after {
  left: 26px;
  box-shadow: 0 2px 8px rgba(168, 230, 207, 0.4);
}

/* ===== í…Œë§ˆ ì„ íƒ ì»¬ëŸ¬ì¹© ===== */
.theme-chips {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.theme-chip {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  border: 2px solid transparent;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  position: relative;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.theme-chip:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
}

.theme-chip.warm {
  background: linear-gradient(135deg, #ff6b5b, #ffa500);
}

.theme-chip.dark {
  background: linear-gradient(135deg, #1e3a8a, #0f172a);
}

.theme-chip.forest {
  background: linear-gradient(135deg, #059669, #10b981);
}

.theme-chip.active {
  border-color: rgba(255, 255, 255, 0.8);
  box-shadow: 0 0 20px rgba(168, 230, 207, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3);
}

.theme-chip::before {
  content: 'âœ“';
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  color: white;
  font-weight: 900;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.theme-chip.active::before {
  opacity: 1;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
}

/* =========================
   PEEK MODE (íŒíŠ¸ì‹œê°„ ëŠë‚Œ)
   ========================= */
body.peeking #board{
  transform: scale(1.03);
  transform-origin: center top; /* âœ… ì¶”ê°€ */
  transition: transform .18s ease;
  will-change: transform;       /* âœ… ì¶”ê°€ */
}

body.peeking .card:not(.messageCard){
  opacity: .88;
  transition: opacity .18s ease;
}

/* ìƒë‹¨ ì˜¤ë²„ë ˆì´ ë°°ë„ˆ */
body.peeking .tile{
  background: rgba(255,255,255,.02);
}

/* ===== ì ê¹ ë„ì›€ë°›ê¸° ë²„íŠ¼ - ë³´ë¼ìƒ‰ ê¸€ë˜ìŠ¤ëª¨í”¼ì¦˜ ===== */
.peek-btn {
  width: 100%;
  height: 44px;
  margin-top: 8px;
  background: linear-gradient(135deg, rgba(138, 43, 226, 0.12), rgba(138, 43, 226, 0.04));
  border: 2px solid rgba(138, 43, 226, 0.35);
  color: var(--text);
  border-radius: var(--radius-small, 16px);
  cursor: pointer;
  font-size: 14px;
  font-weight: 700;
  backdrop-filter: blur(var(--blur-default, 12px));
  box-shadow: 0 4px 15px rgba(138, 43, 226, 0.18), inset 0 1px 0 rgba(255, 255, 255, 0.15);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.peek-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(186, 130, 255, 0.2), transparent);
  transition: left 0.5s;
}

.peek-btn:hover::before {
  left: 100%;
}

.peek-btn:hover {
  background: linear-gradient(135deg, rgba(138, 43, 226, 0.2), rgba(138, 43, 226, 0.1));
  border-color: rgba(138, 43, 226, 0.5);
  box-shadow: 0 6px 20px rgba(138, 43, 226, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.25);
  transform: translateY(-2px);
}

.peek-btn:active {
  transform: translateY(0);
  box-shadow: 0 2px 10px rgba(138, 43, 226, 0.25);
}


/* ëª¨ë°”ì¼ì—ì„œ pill ë ˆì´ì•„ì›ƒ ê°œì„  ë° ì—¬ë°± ì¡°ì • */
@media (max-width: 520px){
  /* ëª¨ë°”ì¼ ì—¬ë°± ë¯¸ì„¸ ì¡°ì • */
  .wrap{
    gap:16px; /* 14px â†’ 16px (+2px) */
  }
  
  /* ìƒë‹¨ ì¹´ë“œ ì—¬ë°± ì¶•ì†Œ - controlsê°€ ë” ì˜ ë³´ì´ë„ë¡ */
  .card:first-child{
    padding: 12px 14px; /* 16px â†’ 12px 14px (ìƒí•˜ ì—¬ë°± ì¶•ì†Œ) */
  }
  
  .sub{
    margin-top: 6px; /* 8px â†’ 6px */
  }
  
  .settingsPanel{
    margin-top: 10px;
    padding: 8px;
    gap: 6px;
  }
  
  .controls{
    gap:15px;
    flex-direction: row !important;
    flex-wrap: nowrap;
  }
  .left-controls{
    display: flex;
    flex-direction: column;
    gap: 8px;
    width: 120px;
  }
  .controls #level{
    flex: 1 1 100%;
    min-width:0;
    width: 120px !important;
    height:36px;
    padding:8px 10px;
    font-size:13px;
  }
  .controls #peekBtn{
    position: static;
    flex: 1 1 100%;
    width: 120px !important;
    font-size:13px;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .controls-hint{
    margin: 0;
    margin-left: auto !important;
    flex: 1;
    font-size: 0.85rem;
    max-width: calc(100% - 160px);
    min-width: 0;
  }
  @media (max-width: 380px){
    .controls #level{ font-size:12px; }
    .controls-hint{ font-size: 0.8rem; }
    .controls #peekBtn{ 
      position: static;
      font-size:12px; 
      padding:8px 8px; 
    }
  }
  
}

/* PC í™˜ê²½ì—ì„œ ì¡°ì‘ë¶€ í¬ê¸° í™•ëŒ€ */
@media (min-width: 768px) {
  .controls-top {
    gap: 12px;
  }
  .controls-top button,
  .controls-top select {
    width: 220px !important;
    height: 50px !important;
    padding: 12px 16px;
    font-size: 1.1rem !important;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .controls {
    gap: 30px;
  }
  .left-controls {
    width: 220px !important;
    gap: 12px;
  }
  .controls #level,
  .controls #peekBtn {
    width: 220px !important;
    height: 50px !important;
    padding: 12px 16px;
    font-size: 1.1rem !important;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .controls-hint {
    align-self: center;
    font-size: 1rem;
  }
}

/* ===== ìƒë‹¨ ì¸ì‚¬ë§ ì»¨í…Œì´ë„ˆ (ì—¬ë°± ìµœì í™”) ===== */
.top-greet {
  margin: 0 auto;
  max-width: 560px;
  width: 100%;
  text-align: center;
  padding: 28px 16px 20px;
  box-sizing: border-box;
}

.top-greet > div:first-child {
  font-size: 18px;
  font-weight: 700;
  line-height: 1.5;
  color: var(--text);
  margin-bottom: 8px;
}

.top-greet > div:last-child {
  font-size: 14px;
  color: var(--muted);
  line-height: 1.6;
  opacity: 0.95;
}

.brand-footer { 
    margin-top: 20px; 
    padding: 20px; 
    text-align: center; 
    font-size: 0.8rem; 
    opacity: 0.5; 
    pointer-events: none;
    user-select: none;
}
/* ìƒë‹¨ í¼ì¦ ì‹¬ë³¼ â€“ í•˜ë£¨ë§ˆìŒ í‘œì¤€ */
.top-title {
  font-size: 28px;          /* ê¸°ì¡´ë³´ë‹¤ í•œ ë‹¨ê³„ í¬ê²Œ (â‰ˆ1.25x) */
  line-height: 1;
  display: inline-flex;
  align-items: center;
  justify-content: center;

  /* ì• ë‹ˆë©”ì´ì…˜ */
  animation:
    puzzleEnter 0.6s ease-out forwards,
    puzzleBreath 4s ease-in-out infinite;
  animation-delay: 0s, 0.8s;

  /* ì¡´ì¬ê°ë§Œ ì‚´ì§ */
  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.25));
}

/* ì²« ë“±ì¥ */
@keyframes puzzleEnter {
  from {
    opacity: 0;
    transform: translateY(6px) scale(0.92);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* ë¯¸ì„¸ í˜¸í¡ */
@keyframes puzzleBreath {
  0%   { transform: scale(1) translateX(-4px); } 
  50%  { transform: scale(1.04) translateX(4px); }
  100% { transform: scale(1) translateX(-4px); }
}

</style>
<link rel="stylesheet" href="../common.css">
</head>
<body data-page="game">
  <div class="wrap">
    <!-- ===== ê¸€ë¼ìŠ¤ëª¨í”¼ì¦˜ ìƒë‹¨ë°” ===== -->
<div class="top-bar">
      <button id="homeBtn" type="button" aria-label="í™ˆìœ¼ë¡œ ì´ë™" title="í™ˆ">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
          <polyline points="9 22 9 12 15 12 15 22"></polyline>
        </svg>
      </button>
      
      <div class="top-title">ê°™ì€ ê·¸ë¦¼ ì°¾ê¸°</div>
      
      <button id="settingsOpenBtn" type="button" aria-label="ì„¤ì •" title="ì„¤ì •">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
          <circle cx="12" cy="12" r="3"></circle>
        </svg>
      </button>
    </div>

    <!-- ===== ìƒë‹¨ íë§ ë©”ì‹œì§€ ===== -->
    <div class="top-greet">
      <div>ì¡°ìš©íˆ ì´ì–´ê°€ë„ ì¢‹ì•„ìš”</div>
      <div>ê°€ë³ê²Œ ì¡°í•©í•´ ë³¼ê¹Œìš”</div>
    </div>

    <!-- ===== ê²Œì„ ë³´ë“œ ===== -->
    <div id="gameBoard" class="game-board-wrapper">
      <div class="board" id="board"></div>
    </div>

    <div style="height: 28px;"></div>

    <!-- ===== íŒíŠ¸ ë²„íŠ¼ ===== -->
    <div class="card">
      <div style="display:flex; justify-content:center;">
        <button id="peekBtn" class="peek-btn" style="display:none;">ğŸ’¡ ì ê¹ ë„ì›€ë°›ê¸°</button>
      </div>
      <select id="peekSec" style="display:none">
        <option value="4">4</option>
      </select>
    </div>
  </div>

  <!-- ===== ëª¨ë‹¬ë“¤ ===== -->
  <div id="modalBack" role="dialog" aria-modal="true" aria-label="ì´ë ‡ê²Œ ë†€ì•„ìš”">
    <div id="modalCard">
      <div class="modalTitle">ë§ˆìŒì„ ëª¨ìœ¼ëŠ” ì‹œê°„</div>
      <div class="modalBody">
        <div class="modalStep"><div class="modalNum">1</div><div>ì§ ì°¾ê¸°: ë’¤ì§‘íŒ ì¹´ë“œì—ì„œ ê°™ì€ ê·¸ë¦¼ì„ ì°¾ì•„ ë§ˆìŒì„ ì´ì–´ì£¼ì„¸ìš”</div></div>
        <div class="modalStep"><div class="modalNum">2</div><div>ì§‘ì¤‘í•˜ê¸°: ë§ì¶˜ ì§ì´ ë§ì„ìˆ˜ë¡ ë§ˆìŒì´ ë”°ëœ»í•´ì ¸ìš”</div></div>
        <div class="modalStep"><div class="modalNum">3</div><div>ì—¬ìœ ë¡­ê²Œ: ìƒˆë¡œìš´ ë°°ì¹˜ë¡œ ì²œì²œíˆ ì¦ê²¨ë³´ì„¸ìš”</div></div>
        <div style="margin-top:10px;color:var(--muted);font-size:12px;">
          * ì²œì²œíˆ í•´ë„ ê´œì°®ì•„ìš” ğŸ™‚
        </div>
      </div>
      <div class="modalActions">
        <button id="modalCloseBtn" type="button">ë‹«ê¸°</button>
      </div>
    </div>
  </div>

  <!-- í†µì¼ëœ ì™„ë£Œ ëª¨ë‹¬ -->
  <div id="completionModal" class="completion-modal">
    <div class="completion-modal-content">
      <div class="completion-emoji" id="completion-emoji">ğŸŒ±</div>
      <div class="completion-base-message" id="completion-base-message"></div>
      <div class="completion-difficulty-message" id="completion-difficulty-message" style="display: none;"></div>
      <div class="completion-buttons">
        <button class="completion-btn completion-btn-home" id="completion-home-btn">í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
        <button class="completion-btn completion-btn-finish" id="completion-finish-btn">ì˜¤ëŠ˜ì€ ì—¬ê¸°ê¹Œì§€</button>
      </div>
    </div>
  </div>

  <!-- ===== Daily Limit Screen ===== -->
  <div id="dailyLimitScreen">
    <div class="daily-limit-content">
      <div class="daily-limit-emoji">ğŸŒ•</div>
      <div class="daily-limit-message" id="dailyLimitMessage"></div>
      <div class="daily-limit-hint">í™”ë©´ì„ íƒ­í•˜ë©´ í™ˆìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤</div>
    </div>
  </div>

  <div id="settingsModalBack" role="dialog" aria-modal="true" aria-label="ê²Œì„ ì„¤ì •">
    <div id="settingsModalCard">
      <div class="settingsModalTitle">
        âš™ï¸ ì„¤ì •
        <button id="settingsModalClose" type="button">âœ•</button>
      </div>

      <!-- íš¨ê³¼ìŒ í† ê¸€ -->
      <div class="settingsSection">
        <div class="settingLabel">íš¨ê³¼ìŒ</div>
        <div class="toggle-switch">
          <span class="toggle-label">ìŒì†Œê±°</span>
          <div id="sfxToggle" class="toggle-input on"></div>
        </div>
      </div>

      <!-- ë°°ê²½ìŒì•… í† ê¸€ -->
      <div class="settingsSection">
        <div class="settingLabel">ë°°ê²½ìŒì•…</div>
        <div class="toggle-switch">
          <span class="toggle-label">ìŒì†Œê±°</span>
          <div id="bgmToggle" class="toggle-input"></div>
        </div>
      </div>

      <!-- í…Œë§ˆ ì„ íƒ -->
      <div class="settingsSection">
        <div class="settingLabel">í…Œë§ˆ</div>
        <div class="theme-chips">
          <div id="themeWarm" class="theme-chip warm active" title="ë”°ëœ»í•œ í…Œë§ˆ"></div>
          <div id="themeDark" class="theme-chip dark" title="ë°¤í•˜ëŠ˜ í…Œë§ˆ"></div>
          <div id="themeForest" class="theme-chip forest" title="ìˆ²ì† í…Œë§ˆ"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== ìŠ¤í¬ë¦½íŠ¸ ===== -->
  <script src="../healingIcons.js?v=2"></script>
  <script src="../core.js?v=3"></script>
  <script src="main.js?v=12"></script>
  
  <script>
    // DOMContentLoaded: ê²Œì„ ì´ˆê¸°í™” + SVG ë²„íŠ¼ ì´ë²¤íŠ¸
    document.addEventListener('DOMContentLoaded', function(){
      // core ê°ì²´ ì´ˆê¸°í™” (í•„ìš”ì‹œ)
      if (!window.core && typeof HaruCore === 'function') {
        window.core = new HaruCore();
      }

      const homeBtn = document.getElementById('homeBtn');
      const settingsBtn = document.getElementById('settingsOpenBtn');
      const settingsModalBack = document.getElementById('settingsModalBack');
      const settingsModalClose = document.getElementById('settingsModalClose');

      // í™ˆ ë²„íŠ¼ í´ë¦­
      if(homeBtn){
        homeBtn.addEventListener('click', () => {
          if(window.core && typeof window.core.playSfx === 'function'){
            window.core.playSfx('click');
          }
          window.location.href = '../index.html';
        });
      }

      // ì„¤ì • ë²„íŠ¼ í´ë¦­
      if(settingsBtn){
        settingsBtn.addEventListener('click', () => {
          if(window.core && typeof window.core.playSfx === 'function'){
            window.core.playSfx('click');
          }
          if(settingsModalBack){
            settingsModalBack.classList.add('isOpen');
            // ëª¨ë‹¬ ì—´ ë•Œ í˜„ì¬ ì„¤ì •ê°’ ë™ê¸°í™”
            syncSettingsModalState();
          }
        });
      }

      // ì„¤ì • ëª¨ë‹¬ ë‹«ê¸°
      if(settingsModalClose){
        settingsModalClose.addEventListener('click', (e) => {
          e.stopPropagation();
          if(settingsModalBack){
            settingsModalBack.classList.remove('isOpen');
          }
        });
      }

      if(settingsModalBack){
        settingsModalBack.addEventListener('click', (e) => {
          if(e.target === settingsModalBack){
            settingsModalBack.classList.remove('isOpen');
          }
        });
      }

      // ===== ì„¤ì • ëª¨ë‹¬ ìƒíƒœ ë™ê¸°í™” í•¨ìˆ˜ =====
      function syncSettingsModalState() {
        // SFX í† ê¸€ ë™ê¸°í™”
        const sfxToggle = document.getElementById('sfxToggle');
        if(sfxToggle && window.core) {
          if(window.core.isSfxOn) {
            sfxToggle.classList.add('on');
          } else {
            sfxToggle.classList.remove('on');
          }
        }

        // BGM í† ê¸€ ë™ê¸°í™”
        const bgmToggle = document.getElementById('bgmToggle');
        if(bgmToggle && window.core) {
          if(window.core.isBgmOn) {
            bgmToggle.classList.add('on');
          } else {
            bgmToggle.classList.remove('on');
          }
        }

        // í…Œë§ˆ ì¹© ë™ê¸°í™”
        const currentTheme = window.core.currentTheme || 'dark';
        document.querySelectorAll('.theme-chip').forEach(chip => {
          chip.classList.remove('active');
        });
        const activeChip = document.getElementById('theme' + capitalizeFirst(currentTheme));
        if(activeChip) {
          activeChip.classList.add('active');
        }
      }

      function capitalizeFirst(str) {
        return str.charAt(0).toUpperCase() + str.slice(1);
      }

      // ===== íš¨ê³¼ìŒ í† ê¸€ =====
      const sfxToggle = document.getElementById('sfxToggle');
      if(sfxToggle){
        sfxToggle.addEventListener('click', (e) => {
          e.stopPropagation();
          // core.jsì˜ toggleSfx() í˜¸ì¶œ
          if(window.core && typeof window.core.toggleSfx === 'function'){
            window.core.toggleSfx();
            // UI ì—…ë°ì´íŠ¸
            if(window.core.isSfxOn) {
              sfxToggle.classList.add('on');
            } else {
              sfxToggle.classList.remove('on');
            }
          }
        });
      }

      // ===== ë°°ê²½ìŒì•… í† ê¸€ =====
      const bgmToggle = document.getElementById('bgmToggle');
      if(bgmToggle){
        bgmToggle.addEventListener('click', (e) => {
          e.stopPropagation();
          // core.jsì˜ toggleBgm() í˜¸ì¶œ
          if(window.core && typeof window.core.toggleBgm === 'function'){
            window.core.toggleBgm();
            // UI ì—…ë°ì´íŠ¸
            if(window.core.isBgmOn) {
              bgmToggle.classList.add('on');
            } else {
              bgmToggle.classList.remove('on');
            }
          }
        });
      }

      // ===== í…Œë§ˆ ì„ íƒ =====
      const themeWarm = document.getElementById('themeWarm');
      const themeDark = document.getElementById('themeDark');
      const themeForest = document.getElementById('themeForest');
      
      const applyThemeFromChip = (themeName) => {
        // core.jsì˜ applyTheme() í˜¸ì¶œ
        if(window.core && typeof window.core.applyTheme === 'function'){
          window.core.applyTheme(themeName);
          // currentThemeë„ ì—…ë°ì´íŠ¸ (coreì—ì„œ ìë™ ì—…ë°ì´íŠ¸ë˜ì§€ë§Œ ëª…ì‹œì ìœ¼ë¡œ)
          window.core.currentTheme = themeName;
        }
        
        // UI ì—…ë°ì´íŠ¸: ëª¨ë“  ì¹©ì˜ active ì œê±°
        document.querySelectorAll('.theme-chip').forEach(chip => {
          chip.classList.remove('active');
        });
        
        // ì„ íƒëœ ì¹©ì— active ì¶”ê°€
        if(themeName === 'warm' && themeWarm) themeWarm.classList.add('active');
        if(themeName === 'dark' && themeDark) themeDark.classList.add('active');
        if(themeName === 'forest' && themeForest) themeForest.classList.add('active');
      };

      if(themeWarm){
        themeWarm.addEventListener('click', (e) => {
          e.stopPropagation();
          applyThemeFromChip('warm');
        });
      }
      if(themeDark){
        themeDark.addEventListener('click', (e) => {
          e.stopPropagation();
          applyThemeFromChip('dark');
        });
      }
      if(themeForest){
        themeForest.addEventListener('click', (e) => {
          e.stopPropagation();
          applyThemeFromChip('forest');
        });
      }

      // ì´ˆê¸° ìƒíƒœ ë™ê¸°í™” (ëª¨ë‹¬ì´ ì²˜ìŒ ì—´ë¦´ ë•Œ)
      syncSettingsModalState();
    });
  </script>
</body>
</html>
